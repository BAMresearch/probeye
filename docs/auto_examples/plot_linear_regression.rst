
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples\plot_linear_regression.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_linear_regression.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_linear_regression.py:


Simple linear regression (sampling)
===================================

A simple linear regression example with two model parameters and one noise parameter.

The model equation is y = a * x + b with a, b being the model parameters and the
noise model is a normal zero-mean distribution with the std. deviation to infer.
The problem is solved via sampling using emcee.

.. GENERATED FROM PYTHON SOURCE LINES 13-14

Import what we will need for this example.

.. GENERATED FROM PYTHON SOURCE LINES 14-23

.. code-block:: default

    import matplotlib.pyplot as plt
    import numpy as np

    from probeye.definition.forward_model import ForwardModelBase
    from probeye.definition.inference_problem import InferenceProblem
    from probeye.definition.likelihood_model import GaussianLikelihoodModel
    from probeye.definition.sensor import Sensor
    from probeye.inference.emcee_.solver import EmceeSolver








.. GENERATED FROM PYTHON SOURCE LINES 24-27

We start by generating a synthetic data set from a known linear model. Later we
will pretend to forgot about the parameters of this ground truth model and will try
to recover them from the data. The slope and intercept of the ground truth model:

.. GENERATED FROM PYTHON SOURCE LINES 27-31

.. code-block:: default


    a_true = 2.5
    b_true = 1.7








.. GENERATED FROM PYTHON SOURCE LINES 32-33

Generate a few data points that we contaminate with a Gaussian error:

.. GENERATED FROM PYTHON SOURCE LINES 33-42

.. code-block:: default

    n_tests = 50
    seed = 1

    np.random.seed(seed)
    x_test = np.linspace(0.0, 1.0, n_tests)
    y_true = a_true * x_test + b_true
    sigma_noise = 0.5
    y_test = y_true + np.random.normal(loc=0, scale=sigma_noise, size=n_tests)








.. GENERATED FROM PYTHON SOURCE LINES 43-44

Visualize our data points

.. GENERATED FROM PYTHON SOURCE LINES 44-49

.. code-block:: default

    plt.plot(x_test, y_test, "o")
    plt.xlabel("x")
    plt.ylabel("y")
    plt.show()




.. image-sg:: /auto_examples/images/sphx_glr_plot_linear_regression_001.png
   :alt: plot linear regression
   :srcset: /auto_examples/images/sphx_glr_plot_linear_regression_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 50-51

Define our parametrized linear model:

.. GENERATED FROM PYTHON SOURCE LINES 51-76

.. code-block:: default

    class LinearModel(ForwardModelBase):
        def response(self, inp):
            # this method *must* be provided by the user
            x = inp["x"]
            m = inp["m"]
            b = inp["b"]
            response = {}
            for os in self.output_sensors:
                response[os.name] = m * x + b
            return response

        def jacobian(self, inp):
            # this method *can* be provided by the user; if not provided
            # the jacobian will be approximated by finite differences
            x = inp["x"]  # vector
            one = np.ones((len(x), 1))
            jacobian = {}
            for os in self.output_sensors:
                # partial derivatives must only be stated for the model
                # parameters; all other input must be flagged by None;
                # note: partial derivatives must be given as column vectors
                jacobian[os.name] = {"x": None, "m": x.reshape(-1, 1), "b": one}
            return jacobian









.. GENERATED FROM PYTHON SOURCE LINES 77-82

Define the inference problem.
Initialize the inference problem with a useful name; note that the
name will only be stored as an attribute of the InferenceProblem and
is not important for the problem itself; can be useful when dealing
with multiple problems

.. GENERATED FROM PYTHON SOURCE LINES 82-85

.. code-block:: default


    problem = InferenceProblem("Linear regression with normal noise")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    2022-02-10 13:42:21.910 | INFO     | # ================================================================================================ # | probeye.subroutines:print_probeye_header:659
    2022-02-10 13:42:21.910 | INFO     | #                                                                                                  # | probeye.subroutines:print_probeye_header:659
    2022-02-10 13:42:21.910 | INFO     | #                                            dP                                                    # | probeye.subroutines:print_probeye_header:659
    2022-02-10 13:42:21.910 | INFO     | #                                            88                                                    # | probeye.subroutines:print_probeye_header:659
    2022-02-10 13:42:21.910 | INFO     | #                  88d888b. 88d888b..d8888b. 88d888b. .d8888b. dP    dP .d8888b.                   # | probeye.subroutines:print_probeye_header:659
    2022-02-10 13:42:21.910 | INFO     | #                  88'  `88 88'     88'  `88 88'  `88 88ooood8 88    88 88ooood8                   # | probeye.subroutines:print_probeye_header:659
    2022-02-10 13:42:21.911 | INFO     | #                  88.  .88 88      88.  .88 88.  .88 88.      88.  .88 88.                        # | probeye.subroutines:print_probeye_header:659
    2022-02-10 13:42:21.911 | INFO     | #                  88Y888P' dP      `88888P' 88Y8888' `88888P' `8888P88 `88888P'                   # | probeye.subroutines:print_probeye_header:659
    2022-02-10 13:42:21.911 | INFO     | #                  88                                                .88                           # | probeye.subroutines:print_probeye_header:659
    2022-02-10 13:42:21.911 | INFO     | #                  dP                                            d8888P                            # | probeye.subroutines:print_probeye_header:659
    2022-02-10 13:42:21.911 | INFO     | #                                                                                                  # | probeye.subroutines:print_probeye_header:659
    2022-02-10 13:42:21.911 | INFO     | # ================================================================================================ # | probeye.subroutines:print_probeye_header:659
    2022-02-10 13:42:21.911 | INFO     | #                                                                                                  # | probeye.subroutines:print_probeye_header:659
    2022-02-10 13:42:21.912 | INFO     | #        Version 2.1.0 - A general framework for setting up parameter estimation problems.         # | probeye.subroutines:print_probeye_header:659
    2022-02-10 13:42:21.912 | INFO     | #                                                                                                  # | probeye.subroutines:print_probeye_header:659
    2022-02-10 13:42:21.912 | INFO     | # ================================================================================================ # | probeye.subroutines:print_probeye_header:659




.. GENERATED FROM PYTHON SOURCE LINES 86-96

Add all parameters to the problem; the first argument states the
parameter's global name (here: 'a', 'b' and 'sigma'); the second
argument defines the parameter type (three options: 'model' for
parameter's of the forward model, 'prior' for prior parameters and
'noise' for parameters of the noise model); the 'info'-argument is a
short description string used for logging, and the tex-argument gives
a tex-string of the parameter used for plotting; finally, the prior-
argument specifies the parameter's prior; note that this definition
of a prior will result in the initialization of constant parameters of
type 'prior' in the background

.. GENERATED FROM PYTHON SOURCE LINES 96-118

.. code-block:: default

    problem.add_parameter(
        "a",
        "model",
        tex="$a$",
        info="Slope of the graph",
        prior=("normal", {"loc": 2.0, "scale": 1.0}),
    )
    problem.add_parameter(
        "b",
        "model",
        info="Intersection of graph with y-axis",
        tex="$b$",
        prior=("normal", {"loc": 1.0, "scale": 1.0}),
    )
    problem.add_parameter(
        "sigma",
        "likelihood",
        tex=r"$\sigma$",
        info="Std. dev, of 0-mean noise model",
        prior=("uniform", {"low": 0.1, "high": 0.8}),
    )








.. GENERATED FROM PYTHON SOURCE LINES 119-133

Add the forward model to the problem; note that the first positional
argument [{'a': 'm'}, 'b'] passed to LinearModel defines the forward
model's parameters by name via a list with elements structured like
{<global parameter name>: <local parameter name>}; a global name is a
name introduced by problem.add_parameter, while a local name is a name
used in the response-method of the forward model class (see the class
LinearModel above); note that the use of the local parameter name 'm'
for the global parameter 'a' is added here only to highlight the
possibility of this feature; it is not necessary at all here; whenever
forward model's parameter has a similar local and global name (which
should be the case most of the times), one doesn't have to use the
verbose notation  {<global parameter name>: <local parameter name>}
but can instead just write the parameter's (global=local) name, like
it is done with the forward model's parameter 'b' below

.. GENERATED FROM PYTHON SOURCE LINES 133-138

.. code-block:: default

    isensor = Sensor("x")
    osensor = Sensor("y")
    linear_model = LinearModel([{"a": "m"}, "b"], [isensor], [osensor])
    problem.add_forward_model("LinearModel", linear_model)








.. GENERATED FROM PYTHON SOURCE LINES 139-140

Add test data to the Inference Problem

.. GENERATED FROM PYTHON SOURCE LINES 140-146

.. code-block:: default

    problem.add_experiment(
        "TestSeries_1",
        fwd_model_name="LinearModel",
        sensor_values={isensor.name: x_test, osensor.name: y_test},
    )








.. GENERATED FROM PYTHON SOURCE LINES 147-148

add the likelihood model to the problem

.. GENERATED FROM PYTHON SOURCE LINES 148-156

.. code-block:: default

    problem.add_likelihood_model(
        GaussianLikelihoodModel(prms_def={"sigma": "std_model"}, sensors=osensor)
    )

    # give problem overview
    problem.info()






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    2022-02-10 13:42:21.920 | INFO     |                                                                                                      | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.920 | INFO     | Problem summary: Linear regression with normal noise                                                 | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.920 | INFO     | ====================================================                                                 | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.920 | INFO     |                                                                                                      | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.920 | INFO     | Forward models                                                                                       | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.921 | INFO     | ---------------------------------------------------------                                            | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.921 | INFO     |  Model name   | Global parameters   | Local parameters                                               | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.921 | INFO     | --------------+---------------------+--------------------                                            | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.921 | INFO     |  LinearModel  | a, b                | m, b                                                           | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.921 | INFO     |                                                                                                      | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.921 | INFO     | Priors                                                                                               | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.921 | INFO     | -----------------------------------------------------------------------------                        | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.921 | INFO     |  Prior name    | Global parameters            | Local parameters                                     | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.922 | INFO     | ---------------+------------------------------+------------------------------                        | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.922 | INFO     |  a_normal      | a, loc_a, scale_a            | a, loc_a, scale_a                                    | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.922 | INFO     |  b_normal      | b, loc_b, scale_b            | b, loc_b, scale_b                                    | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.922 | INFO     |  sigma_uniform | sigma, low_sigma, high_sigma | sigma, low_sigma, high_sigma                         | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.922 | INFO     |                                                                                                      | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.922 | INFO     | Parameter overview                                                                                   | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.922 | INFO     | -----------------------------------------------------------------------------------------            | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.922 | INFO     |  Parameter type/role   | Parameter names                                       |   Count             | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.923 | INFO     | -----------------------+-------------------------------------------------------+---------            | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.923 | INFO     |  Model parameters      | a, b                                                  |       2             | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.923 | INFO     |  Prior parameters      | loc_a, scale_a, loc_b, scale_b, low_sigma, high_sigma |       6             | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.923 | INFO     |  Likelihood parameters | sigma                                                 |       1             | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.923 | INFO     |  Const parameters      | loc_a, scale_a, loc_b, scale_b, low_sigma, high_sigma |       6             | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.923 | INFO     |  Latent parameters     | a, b, sigma                                           |       3             | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.923 | INFO     |                                                                                                      | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.924 | INFO     | Parameter explanations                                                                               | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.924 | INFO     | ---------------------------------------------------------------------                                | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.924 | INFO     |  Name       | Short explanation                                                                      | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.924 | INFO     | ------------+--------------------------------------------------------                                | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.924 | INFO     |  loc_a      | Normal prior's parameter for latent parameter 'a'                                      | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.925 | INFO     |  scale_a    | Normal prior's parameter for latent parameter 'a'                                      | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.925 | INFO     |  a          | Slope of the graph                                                                     | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.925 | INFO     |  loc_b      | Normal prior's parameter for latent parameter 'b'                                      | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.925 | INFO     |  scale_b    | Normal prior's parameter for latent parameter 'b'                                      | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.925 | INFO     |  b          | Intersection of graph with y-axis                                                      | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.925 | INFO     |  low_sigma  | Uniform prior's parameter for latent parameter 'sigma'                                 | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.925 | INFO     |  high_sigma | Uniform prior's parameter for latent parameter 'sigma'                                 | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.926 | INFO     |  sigma      | Std. dev, of 0-mean noise model                                                        | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.926 | INFO     |                                                                                                      | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.926 | INFO     | Constant parameters                                                                                  | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.926 | INFO     | ----------------------                                                                               | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.926 | INFO     |  Name       |   Value                                                                                | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.926 | INFO     | ------------+---------                                                                               | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.926 | INFO     |  loc_a      |     2                                                                                  | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.926 | INFO     |  scale_a    |     1                                                                                  | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.927 | INFO     |  loc_b      |     1                                                                                  | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.927 | INFO     |  scale_b    |     1                                                                                  | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.927 | INFO     |  low_sigma  |     0.1                                                                                | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.927 | INFO     |  high_sigma |     0.8                                                                                | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.927 | INFO     |                                                                                                      | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.927 | INFO     | Theta interpretation                                                                                 | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.927 | INFO     | +---------------------------+                                                                        | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.928 | INFO     | |  Theta  |    Parameter    |                                                                        | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.928 | INFO     | |  index  |      name       |                                                                        | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.928 | INFO     | |---------------------------|                                                                        | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.928 | INFO     | |      0 --> a              |                                                                        | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.928 | INFO     | |      1 --> b              |                                                                        | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.928 | INFO     | |      2 --> sigma          |                                                                        | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.928 | INFO     | +---------------------------+                                                                        | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.928 | INFO     |                                                                                                      | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.929 | INFO     | Added experiments                                                                                    | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.929 | INFO     | --------------------------------------------------                                                   | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.929 | INFO     |  Name         | Sensor values   | Forward model                                                      | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.929 | INFO     | --------------+-----------------+-----------------                                                   | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.929 | INFO     |  TestSeries_1 | x (50 elements) | LinearModel                                                        | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.929 | INFO     |               | y (50 elements) |                                                                    | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.929 | INFO     |                                                                                                      | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.930 | INFO     | Added likelihood models                                                                              | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.930 | INFO     | ------------------------------------------------------------------------------------                 | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.930 | INFO     |  Name               | Glob. prms   | Loc. prms   | Target sensors   | Experiments                    | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.930 | INFO     | --------------------+--------------+-------------+------------------+---------------                 | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.930 | INFO     |  likelihood_model_0 | sigma        | std_model   | y                | TestSeries_1                   | probeye.definition.inference_problem:info:1145
    2022-02-10 13:42:21.930 | INFO     |                                                                                                      | probeye.definition.inference_problem:info:1145

    "\nProblem summary: Linear regression with normal noise\n====================================================\n\nForward models\n---------------------------------------------------------\n Model name   | Global parameters   | Local parameters\n--------------+---------------------+--------------------\n LinearModel  | a, b                | m, b\n\nPriors\n-----------------------------------------------------------------------------\n Prior name    | Global parameters            | Local parameters\n---------------+------------------------------+------------------------------\n a_normal      | a, loc_a, scale_a            | a, loc_a, scale_a\n b_normal      | b, loc_b, scale_b            | b, loc_b, scale_b\n sigma_uniform | sigma, low_sigma, high_sigma | sigma, low_sigma, high_sigma\n\nParameter overview\n-----------------------------------------------------------------------------------------\n Parameter type/role   | Parameter names                                       |   Count\n-----------------------+-------------------------------------------------------+---------\n Model parameters      | a, b                                                  |       2\n Prior parameters      | loc_a, scale_a, loc_b, scale_b, low_sigma, high_sigma |       6\n Likelihood parameters | sigma                                                 |       1\n Const parameters      | loc_a, scale_a, loc_b, scale_b, low_sigma, high_sigma |       6\n Latent parameters     | a, b, sigma                                           |       3\n\nParameter explanations\n---------------------------------------------------------------------\n Name       | Short explanation\n------------+--------------------------------------------------------\n loc_a      | Normal prior's parameter for latent parameter 'a'\n scale_a    | Normal prior's parameter for latent parameter 'a'\n a          | Slope of the graph\n loc_b      | Normal prior's parameter for latent parameter 'b'\n scale_b    | Normal prior's parameter for latent parameter 'b'\n b          | Intersection of graph with y-axis\n low_sigma  | Uniform prior's parameter for latent parameter 'sigma'\n high_sigma | Uniform prior's parameter for latent parameter 'sigma'\n sigma      | Std. dev, of 0-mean noise model\n\nConstant parameters\n----------------------\n Name       |   Value\n------------+---------\n loc_a      |     2\n scale_a    |     1\n loc_b      |     1\n scale_b    |     1\n low_sigma  |     0.1\n high_sigma |     0.8\n\nTheta interpretation\n+---------------------------+\n|  Theta  |    Parameter    |\n|  index  |      name       |\n|---------------------------|\n|      0 --> a              |\n|      1 --> b              |\n|      2 --> sigma          |\n+---------------------------+\n\nAdded experiments\n--------------------------------------------------\n Name         | Sensor values   | Forward model\n--------------+-----------------+-----------------\n TestSeries_1 | x (50 elements) | LinearModel\n              | y (50 elements) |\n\nAdded likelihood models\n------------------------------------------------------------------------------------\n Name               | Glob. prms   | Loc. prms   | Target sensors   | Experiments\n--------------------+--------------+-------------+------------------+---------------\n likelihood_model_0 | sigma        | std_model   | y                | TestSeries_1\n"



.. GENERATED FROM PYTHON SOURCE LINES 157-158

Estimate the parameters using `emcee`

.. GENERATED FROM PYTHON SOURCE LINES 158-160

.. code-block:: default

    emcee_solver = EmceeSolver(problem, show_progress=True)
    inference_data = emcee_solver.run_mcmc(n_walkers=20, n_steps=2_000, n_initial_steps=200)




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    2022-02-10 13:42:21.932 | INFO     | Solving problem using emcee sampler with 200 + 2000 samples and 20 walkers                           | probeye.inference.emcee_.solver:run_mcmc:165
    2022-02-10 13:42:21.932 | INFO     | No additional options specified                                                                      | probeye.inference.emcee_.solver:run_mcmc:173
      0%|                                                                                          | 0/200 [00:00<?, ?it/s]      6%|####4                                                                           | 11/200 [00:00<00:01, 104.05it/s]     11%|########8                                                                       | 22/200 [00:00<00:01, 103.45it/s]     16%|#############2                                                                  | 33/200 [00:00<00:01, 106.02it/s]     22%|#################6                                                              | 44/200 [00:00<00:01, 107.25it/s]     28%|######################                                                          | 55/200 [00:00<00:01, 106.80it/s]     33%|##########################4                                                     | 66/200 [00:00<00:01, 107.61it/s]     38%|##############################8                                                 | 77/200 [00:00<00:01, 107.79it/s]     44%|###################################2                                            | 88/200 [00:00<00:01, 106.90it/s]     50%|#######################################6                                        | 99/200 [00:00<00:00, 106.95it/s]     55%|###########################################4                                   | 110/200 [00:01<00:00, 106.67it/s]     60%|###############################################7                               | 121/200 [00:01<00:00, 106.48it/s]     66%|####################################################1                          | 132/200 [00:01<00:00, 107.29it/s]     72%|########################################################4                      | 143/200 [00:01<00:00, 106.90it/s]     77%|############################################################8                  | 154/200 [00:01<00:00, 103.63it/s]     82%|#################################################################1             | 165/200 [00:01<00:00, 103.75it/s]     88%|#####################################################################5         | 176/200 [00:01<00:00, 102.11it/s]     94%|#########################################################################8     | 187/200 [00:01<00:00, 102.11it/s]     99%|##############################################################################2| 198/200 [00:01<00:00, 101.83it/s]    100%|###############################################################################| 200/200 [00:01<00:00, 104.82it/s]
      0%|                                                                                         | 0/2000 [00:00<?, ?it/s]      1%|4                                                                              | 11/2000 [00:00<00:18, 107.04it/s]      1%|8                                                                              | 22/2000 [00:00<00:18, 107.08it/s]      2%|#3                                                                             | 33/2000 [00:00<00:18, 108.02it/s]      2%|#7                                                                             | 44/2000 [00:00<00:18, 108.06it/s]      3%|##1                                                                            | 55/2000 [00:00<00:18, 106.59it/s]      3%|##6                                                                            | 66/2000 [00:00<00:17, 107.45it/s]      4%|###                                                                            | 77/2000 [00:00<00:18, 106.32it/s]      4%|###4                                                                           | 88/2000 [00:00<00:17, 106.57it/s]      5%|###9                                                                           | 99/2000 [00:00<00:17, 106.09it/s]      6%|####2                                                                         | 110/2000 [00:01<00:17, 105.75it/s]      6%|####7                                                                         | 121/2000 [00:01<00:17, 106.15it/s]      7%|#####1                                                                        | 132/2000 [00:01<00:17, 106.75it/s]      7%|#####5                                                                        | 143/2000 [00:01<00:17, 105.01it/s]      8%|######                                                                        | 154/2000 [00:01<00:17, 105.01it/s]      8%|######4                                                                       | 165/2000 [00:01<00:17, 103.83it/s]      9%|######8                                                                       | 176/2000 [00:01<00:18, 101.03it/s]      9%|#######2                                                                      | 187/2000 [00:01<00:17, 103.06it/s]     10%|#######7                                                                      | 198/2000 [00:01<00:17, 104.83it/s]     10%|########1                                                                     | 209/2000 [00:01<00:16, 105.50it/s]     11%|########5                                                                     | 220/2000 [00:02<00:16, 105.36it/s]     12%|#########                                                                     | 231/2000 [00:02<00:16, 105.88it/s]     12%|#########5                                                                     | 242/2000 [00:02<00:18, 95.47it/s]     13%|#########9                                                                     | 252/2000 [00:02<00:21, 81.36it/s]     13%|##########3                                                                    | 263/2000 [00:02<00:19, 86.96it/s]     14%|##########8                                                                    | 274/2000 [00:02<00:18, 92.47it/s]     14%|###########2                                                                   | 285/2000 [00:02<00:17, 96.19it/s]     15%|###########6                                                                   | 296/2000 [00:02<00:17, 99.24it/s]     15%|###########9                                                                  | 307/2000 [00:03<00:16, 100.65it/s]     16%|############4                                                                 | 318/2000 [00:03<00:16, 102.49it/s]     16%|############8                                                                 | 329/2000 [00:03<00:16, 103.25it/s]     17%|#############2                                                                | 340/2000 [00:03<00:16, 101.21it/s]     18%|#############6                                                                | 351/2000 [00:03<00:16, 102.04it/s]     18%|##############1                                                               | 362/2000 [00:03<00:16, 101.22it/s]     19%|##############5                                                               | 373/2000 [00:03<00:15, 102.62it/s]     19%|##############9                                                               | 384/2000 [00:03<00:15, 104.51it/s]     20%|###############4                                                              | 395/2000 [00:03<00:15, 104.97it/s]     20%|###############8                                                              | 406/2000 [00:03<00:15, 105.29it/s]     21%|################2                                                             | 417/2000 [00:04<00:15, 105.52it/s]     21%|################6                                                             | 428/2000 [00:04<00:14, 106.29it/s]     22%|#################1                                                            | 439/2000 [00:04<00:14, 107.14it/s]     22%|#################5                                                            | 450/2000 [00:04<00:14, 107.44it/s]     23%|#################9                                                            | 461/2000 [00:04<00:14, 107.33it/s]     24%|##################4                                                           | 472/2000 [00:04<00:14, 105.71it/s]     24%|##################8                                                           | 483/2000 [00:04<00:14, 105.51it/s]     25%|###################2                                                          | 494/2000 [00:04<00:14, 106.28it/s]     25%|###################6                                                          | 505/2000 [00:04<00:14, 106.21it/s]     26%|####################1                                                         | 516/2000 [00:05<00:14, 105.86it/s]     26%|####################5                                                         | 527/2000 [00:05<00:14, 104.41it/s]     27%|####################9                                                         | 538/2000 [00:05<00:14, 104.02it/s]     27%|#####################4                                                        | 549/2000 [00:05<00:13, 105.52it/s]     28%|#####################8                                                        | 560/2000 [00:05<00:13, 104.17it/s]     29%|######################5                                                        | 571/2000 [00:05<00:17, 83.36it/s]     29%|######################9                                                        | 581/2000 [00:05<00:16, 86.86it/s]     30%|#######################3                                                       | 592/2000 [00:05<00:15, 92.41it/s]     30%|#######################8                                                       | 603/2000 [00:05<00:14, 96.69it/s]     31%|########################2                                                      | 614/2000 [00:06<00:13, 99.08it/s]     31%|########################3                                                     | 625/2000 [00:06<00:13, 101.65it/s]     32%|########################8                                                     | 636/2000 [00:06<00:13, 103.22it/s]     32%|#########################2                                                    | 647/2000 [00:06<00:12, 104.36it/s]     33%|#########################6                                                    | 658/2000 [00:06<00:12, 105.45it/s]     33%|##########################                                                    | 669/2000 [00:06<00:12, 103.85it/s]     34%|##########################5                                                   | 680/2000 [00:06<00:12, 101.61it/s]     35%|##########################9                                                   | 691/2000 [00:06<00:12, 102.90it/s]     35%|###########################3                                                  | 702/2000 [00:06<00:12, 104.71it/s]     36%|###########################8                                                  | 713/2000 [00:06<00:12, 105.71it/s]     36%|############################2                                                 | 724/2000 [00:07<00:12, 104.01it/s]     37%|############################6                                                 | 735/2000 [00:07<00:12, 104.92it/s]     37%|#############################                                                 | 746/2000 [00:07<00:11, 106.18it/s]     38%|#############################5                                                | 757/2000 [00:07<00:11, 105.22it/s]     38%|#############################9                                                | 768/2000 [00:07<00:11, 105.17it/s]     39%|##############################7                                                | 779/2000 [00:07<00:13, 90.39it/s]     40%|###############################2                                               | 790/2000 [00:07<00:12, 95.07it/s]     40%|###############################6                                               | 801/2000 [00:07<00:12, 98.64it/s]     41%|################################                                               | 812/2000 [00:07<00:11, 99.93it/s]     41%|################################                                              | 823/2000 [00:08<00:11, 100.86it/s]     42%|################################9                                              | 834/2000 [00:08<00:12, 92.55it/s]     42%|#################################3                                             | 844/2000 [00:08<00:21, 54.59it/s]     43%|#################################6                                             | 852/2000 [00:08<00:21, 53.53it/s]     43%|##################################                                             | 863/2000 [00:08<00:18, 63.01it/s]     44%|##################################5                                            | 874/2000 [00:08<00:15, 72.41it/s]     44%|##################################9                                            | 885/2000 [00:09<00:13, 80.88it/s]     45%|###################################3                                           | 896/2000 [00:09<00:12, 87.03it/s]     45%|###################################8                                           | 907/2000 [00:09<00:11, 92.07it/s]     46%|####################################2                                          | 918/2000 [00:09<00:11, 96.68it/s]     46%|####################################6                                          | 929/2000 [00:09<00:10, 98.80it/s]     47%|####################################6                                         | 940/2000 [00:09<00:10, 101.43it/s]     48%|#####################################                                         | 951/2000 [00:09<00:10, 103.08it/s]     48%|#####################################5                                        | 962/2000 [00:09<00:10, 101.37it/s]     49%|#####################################9                                        | 973/2000 [00:09<00:09, 103.02it/s]     49%|######################################3                                       | 984/2000 [00:10<00:09, 103.90it/s]     50%|######################################8                                       | 995/2000 [00:10<00:09, 104.24it/s]     50%|######################################7                                      | 1006/2000 [00:10<00:09, 103.60it/s]     51%|#######################################1                                     | 1018/2000 [00:10<00:09, 105.08it/s]     51%|#######################################6                                     | 1029/2000 [00:10<00:09, 105.37it/s]     52%|########################################                                     | 1040/2000 [00:10<00:09, 106.17it/s]     53%|########################################4                                    | 1051/2000 [00:10<00:08, 105.53it/s]     53%|########################################8                                    | 1062/2000 [00:10<00:08, 106.60it/s]     54%|#########################################3                                   | 1073/2000 [00:10<00:08, 107.05it/s]     54%|#########################################7                                   | 1084/2000 [00:10<00:08, 107.68it/s]     55%|##########################################1                                  | 1095/2000 [00:11<00:08, 107.50it/s]     55%|##########################################5                                  | 1106/2000 [00:11<00:08, 107.69it/s]     56%|###########################################                                  | 1117/2000 [00:11<00:08, 107.82it/s]     56%|###########################################4                                 | 1128/2000 [00:11<00:08, 108.23it/s]     57%|###########################################8                                 | 1139/2000 [00:11<00:08, 106.31it/s]     57%|############################################2                                | 1150/2000 [00:11<00:08, 106.22it/s]     58%|############################################6                                | 1161/2000 [00:11<00:07, 106.18it/s]     59%|#############################################1                               | 1172/2000 [00:11<00:07, 107.07it/s]     59%|#############################################5                               | 1183/2000 [00:11<00:07, 107.69it/s]     60%|#############################################9                               | 1194/2000 [00:11<00:07, 106.89it/s]     60%|##############################################3                              | 1205/2000 [00:12<00:07, 106.01it/s]     61%|##############################################8                              | 1216/2000 [00:12<00:07, 106.02it/s]     61%|###############################################2                             | 1227/2000 [00:12<00:07, 106.34it/s]     62%|###############################################6                             | 1238/2000 [00:12<00:07, 107.18it/s]     62%|################################################                             | 1249/2000 [00:12<00:07, 106.84it/s]     63%|################################################5                            | 1260/2000 [00:12<00:06, 106.28it/s]     64%|################################################9                            | 1271/2000 [00:12<00:06, 106.22it/s]     64%|#################################################3                           | 1282/2000 [00:12<00:06, 106.18it/s]     65%|#################################################7                           | 1293/2000 [00:12<00:06, 106.44it/s]     65%|##################################################2                          | 1304/2000 [00:13<00:06, 106.64it/s]     66%|##################################################6                          | 1315/2000 [00:13<00:06, 106.14it/s]     66%|###################################################                          | 1326/2000 [00:13<00:06, 105.21it/s]     67%|###################################################4                         | 1337/2000 [00:13<00:06, 105.46it/s]     67%|###################################################8                         | 1348/2000 [00:13<00:06, 104.73it/s]     68%|####################################################3                        | 1359/2000 [00:13<00:06, 105.12it/s]     68%|####################################################7                        | 1370/2000 [00:13<00:05, 105.70it/s]     69%|#####################################################1                       | 1381/2000 [00:13<00:05, 106.42it/s]     70%|#####################################################5                       | 1392/2000 [00:13<00:05, 105.39it/s]     70%|######################################################                       | 1403/2000 [00:13<00:05, 105.29it/s]     71%|######################################################4                      | 1414/2000 [00:14<00:05, 106.13it/s]     71%|######################################################8                      | 1425/2000 [00:14<00:05, 106.10it/s]     72%|#######################################################2                     | 1436/2000 [00:14<00:05, 105.48it/s]     72%|#######################################################7                     | 1447/2000 [00:14<00:05, 105.95it/s]     73%|########################################################1                    | 1458/2000 [00:14<00:05, 106.59it/s]     73%|########################################################5                    | 1469/2000 [00:14<00:04, 107.36it/s]     74%|########################################################9                    | 1480/2000 [00:14<00:04, 106.97it/s]     75%|#########################################################4                   | 1491/2000 [00:14<00:04, 106.69it/s]     75%|#########################################################8                   | 1502/2000 [00:14<00:04, 105.88it/s]     76%|##########################################################2                  | 1513/2000 [00:14<00:04, 105.63it/s]     76%|##########################################################6                  | 1524/2000 [00:15<00:04, 106.06it/s]     77%|###########################################################                  | 1535/2000 [00:15<00:04, 106.36it/s]     77%|###########################################################5                 | 1546/2000 [00:15<00:04, 106.28it/s]     78%|###########################################################9                 | 1557/2000 [00:15<00:04, 106.83it/s]     78%|############################################################3                | 1568/2000 [00:15<00:04, 107.52it/s]     79%|#############################################################5                | 1579/2000 [00:15<00:05, 82.93it/s]     79%|#############################################################9                | 1589/2000 [00:15<00:05, 81.22it/s]     80%|##############################################################4               | 1600/2000 [00:15<00:04, 87.69it/s]     81%|##############################################################8               | 1611/2000 [00:16<00:04, 92.80it/s]     81%|###############################################################2              | 1622/2000 [00:16<00:03, 96.97it/s]     82%|###############################################################6              | 1633/2000 [00:16<00:03, 99.81it/s]     82%|###############################################################2             | 1644/2000 [00:16<00:03, 101.61it/s]     83%|###############################################################7             | 1655/2000 [00:16<00:03, 102.63it/s]     83%|################################################################1            | 1666/2000 [00:16<00:03, 101.06it/s]     84%|#################################################################4            | 1677/2000 [00:16<00:03, 97.86it/s]     84%|#################################################################7            | 1687/2000 [00:16<00:03, 94.61it/s]     85%|##################################################################1           | 1697/2000 [00:16<00:03, 95.64it/s]     85%|##################################################################5           | 1707/2000 [00:16<00:03, 94.29it/s]     86%|##################################################################9           | 1717/2000 [00:17<00:03, 93.09it/s]     86%|###################################################################3          | 1727/2000 [00:17<00:02, 93.27it/s]     87%|###################################################################7          | 1737/2000 [00:17<00:02, 90.88it/s]     87%|####################################################################1         | 1747/2000 [00:17<00:02, 90.72it/s]     88%|####################################################################5         | 1758/2000 [00:17<00:02, 95.10it/s]     88%|####################################################################9         | 1769/2000 [00:17<00:02, 98.27it/s]     89%|####################################################################5        | 1780/2000 [00:17<00:02, 100.83it/s]     90%|####################################################################9        | 1792/2000 [00:17<00:02, 103.47it/s]     90%|#####################################################################4       | 1803/2000 [00:17<00:01, 104.22it/s]     91%|#####################################################################8       | 1814/2000 [00:18<00:01, 104.76it/s]     91%|######################################################################2      | 1825/2000 [00:18<00:01, 104.69it/s]     92%|######################################################################6      | 1836/2000 [00:18<00:01, 105.09it/s]     92%|#######################################################################1     | 1847/2000 [00:18<00:01, 105.97it/s]     93%|#######################################################################5     | 1858/2000 [00:18<00:01, 105.40it/s]     93%|#######################################################################9     | 1869/2000 [00:18<00:01, 105.29it/s]     94%|########################################################################3    | 1880/2000 [00:18<00:01, 105.22it/s]     95%|########################################################################8    | 1892/2000 [00:18<00:01, 107.42it/s]     95%|#########################################################################2   | 1903/2000 [00:18<00:00, 107.00it/s]     96%|#########################################################################6   | 1914/2000 [00:19<00:00, 106.11it/s]     96%|##########################################################################1  | 1925/2000 [00:19<00:00, 105.19it/s]     97%|##########################################################################5  | 1936/2000 [00:19<00:00, 104.56it/s]     97%|##########################################################################9  | 1947/2000 [00:19<00:00, 105.30it/s]     98%|###########################################################################3 | 1958/2000 [00:19<00:00, 105.83it/s]     98%|###########################################################################8 | 1969/2000 [00:19<00:00, 105.29it/s]     99%|############################################################################2| 1980/2000 [00:19<00:00, 106.12it/s]    100%|############################################################################6| 1991/2000 [00:19<00:00, 103.42it/s]    100%|#############################################################################| 2000/2000 [00:19<00:00, 100.76it/s]
    2022-02-10 13:42:43.748 | INFO     | Sampling of the posterior distribution completed: 2000 steps and 20 walkers.                         | probeye.inference.emcee_.solver:run_mcmc:232
    2022-02-10 13:42:43.748 | INFO     | Total run-time (including initial sampling): 21s.                                                    | probeye.inference.emcee_.solver:run_mcmc:236
    2022-02-10 13:42:43.748 | INFO     |                                                                                                      | probeye.inference.emcee_.solver:run_mcmc:237
    2022-02-10 13:42:43.749 | INFO     | Summary of sampling results (emcee)                                                                  | probeye.inference.emcee_.solver:run_mcmc:238
    2022-02-10 13:42:43.767 | INFO     |          mean    median    sd    5%    95%                                                           | probeye.inference.emcee_.solver:emcee_summary:124
    2022-02-10 13:42:43.767 | INFO     | -----  ------  --------  ----  ----  -----                                                           | probeye.inference.emcee_.solver:emcee_summary:124
    2022-02-10 13:42:43.767 | INFO     | a        2.68      2.68  0.23  2.30   3.07                                                           | probeye.inference.emcee_.solver:emcee_summary:124
    2022-02-10 13:42:43.768 | INFO     | b        1.60      1.60  0.14  1.37   1.82                                                           | probeye.inference.emcee_.solver:emcee_summary:124
    2022-02-10 13:42:43.768 | INFO     | sigma    0.50      0.50  0.05  0.42   0.60                                                           | probeye.inference.emcee_.solver:emcee_summary:124
    2022-02-10 13:42:43.768 | INFO     |                                                                                                      | probeye.inference.emcee_.solver:run_mcmc:244





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  21.965 seconds)


.. _sphx_glr_download_auto_examples_plot_linear_regression.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_linear_regression.py <plot_linear_regression.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_linear_regression.ipynb <plot_linear_regression.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
